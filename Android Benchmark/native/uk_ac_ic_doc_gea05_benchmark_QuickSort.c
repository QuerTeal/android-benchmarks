/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class uk_ac_ic_doc_gea05_benchmark_QuickSort */

#ifndef _Included_uk_ac_ic_doc_gea05_benchmark_QuickSort
#define _Included_uk_ac_ic_doc_gea05_benchmark_QuickSort
#ifdef __cplusplus
extern "C" {
#endif
#undef uk_ac_ic_doc_gea05_benchmark_QuickSort_CUTOFF
#define uk_ac_ic_doc_gea05_benchmark_QuickSort_CUTOFF 10L

//median of 3 quick sort.

void exchange(int list[], int p, int q) {
	int temp = list[p];
	list[p] = list[q];
	list[q] = temp;
}

int partition(int list[], int p, int r) {
	int x = list[r];
	int i = p - 1;
	int j;
	for (j = p; j < r; j++) {
		if (list[j] <= x) {
			i++;
			exchange(list, i, j);
		}
	}
	exchange(list, i + 1, r);
	return i + 1;
}

int median_of_3(int list[], int p, int r) {
	int median = (p + r) / 2;

	if (list[p] > list[r])
		exchange(list, p, r);
	if (list[p] > list[median])
		exchange(list, p, median);
	if (list[r] > list[median])
		exchange(list, r, median);

	return list[r];
}

void quicksort(int list[], int p, int r) {
	if (p < r) {
		median_of_3(list, p, r);

		int q = partition(list, p, r);
		quicksort(list, p, q - 1);
		quicksort(list, q + 1, r);
	}
}

/*
 * Class:     uk_ac_ic_doc_gea05_benchmark_QuickSort
 * Method:    nQuicksort
 * Signature: ([III)V
 */
JNIEXPORT void JNICALL Java_uk_ac_ic_doc_gea05_benchmark_QuickSort_nQuicksort(
		JNIEnv *env, jclass c, jintArray jInput) {
	// Copy the arrays into main memory
	jint* cInput = (*env)->GetIntArrayElements(env, jInput, 0);
	jsize length = (*env)->GetArrayLength(env, jInput);

	quicksort(cInput, 0, length - 1);

	(*env)->SetIntArrayRegion(env, jInput, 0, length, cInput);
	(*env)->ReleaseIntArrayElements(env, jInput, cInput, 0);
}

#ifdef __cplusplus
}
#endif
#endif
